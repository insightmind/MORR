\newcommand{\bug}[3]{\begin{minipage}{\textwidth}\textbf{Bug:} #1 \\ \textbf{Identified cause:} #2 \\ \textbf{Implemented fix:} #3 \end{minipage}\vskip.2\baselineskip}

\chapter{Issues}

The primary purpose of the testing phase is to identify and correct issues with the MORR application. This chapter lists the issues that were found, along with their identified causes and the fixes that were implemented to resolve them.

\raggedright

\section{Core}

\bug{DllNotFoundException thrown for vcruntime140\_cor3.dll when closing the application}{The mouse module has a dependency on PresentationCore.dll, which in turn has a dependency on DirectWriteForwarder.dll, which has a dependency on vcruntime140\_cor3.dll. As there is no direct dependency between the module and the DLL, the DLL will not be available to the application, causing the exception to be thrown.}{Copy vcruntime140\_cor3.dll to the output directory so it is available to the application.}
\bug{Using the GraphicsCapturePicker when running from the UI causes an exception to be thrown.}{When running from the UI, there is no console window attached to the process and there may not always be an active window associated with the process when the picking mechanism is activated. As such, the call to IInitializeWithWindow.SetWindow on the GraphicsCapturePicker will not set a valid window and the attempt to pick a monitor or window will fail.}{When running from the UI, create a new Window from the WPF context that stays open for the duration of the picking operation and will be used in the call to IInitializeWithWindow.SetWindow.}

\section{Modules}
\subsection{KeyboardModule}
\bug{Certain keypresses, especially when the ALT key is held down, are not recorded as events.}{System keys (such as F10 or ALT-combinations) trigger a specific WM\_SYSKEYDOWN message instead of WM\_KEYDOWN.}{Handle WM\_SYSKEYDOWN messages in addition to WM\_KEYDOWN.}

\subsection{WebBrowserModule}
\bug{The WebBrowserModule will accept connections from the browser extension even when the WebBrowserModule is deactivated.}{The internal listener will get started in the initialization routine, disregarding the passed parameter.}{The interal listener will only be started if "isEnabled" is true.}