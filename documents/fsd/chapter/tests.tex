\chapter{Global test cases}
\label{ch:tests}

%%Cannot use requirementscope as we have to inject additional text into the label
\newcounter{counterTC}

\makeatletter
\newcommand{\fmt}[1]{(tests \specref{#1}\checknextarg}
\newcommand{\checknextarg}{\@ifnextchar\bgroup{\consumenextarg}{)}}
\newcommand{\consumenextarg}[1]{, \specref{#1}\@ifnextchar\bgroup{\consumenextarg}{)}}
\makeatother

\newcommand{\test}[5]{\addtocounter{counterTC}{10}
\item[TC\arabic{counterTC}\phantomsection\label{TC\arabic{counterTC}}\\\begin{footnotesize}\textit{#1}\end{footnotesize}]
    \begin{itemize}[noitemsep]
        \item[]{\textbf{#2}} %title
        \item[]{Precondition: #3}
        \item[]{Test steps: #4}
        \item[]{Expected result: #5}
    \end{itemize}
}

\newenvironment{tests}{\begin{itemize}[font = \normalfont, style = multiline, labelwidth = 60pt, leftmargin = !]}{\end{itemize}}

\section{High-level test cases}

\begin{tests}
    \test{\fmt{FS10}{FS250}{FS54}{FS70}{FS90}{FS340}{FS350}}{Identifiable sessions}{The application is running. The configuration file is valid.}
    {The \gls{user} repeats the following 256 times:
    \begin{enumerate}
        \item The \gls{user} starts a recording.
        \item The \gls{user} stops the recording.
    \end{enumerate}}
    {\begin{itemize}
        \item 256 recordings have been generated (in accordance with \ref{sec:session_recordings}) and stored at the path specified by the configuration.
        \item Each recording contains a different session identifier (as specified in \specref{D20}).
    \end{itemize}}

    \test{\fmt{FS20}{FS250}{FS54}{FS70}{FS90}{FS340}{FS350}}{Event timings}{The application is running. The configuration file is valid.}
    {\begin{enumerate}
        \item The \gls{user} starts a recording.
        \item The \gls{user} performs an action that generates an \gls{event} at time X.
        \item The \gls{user} performs another action that generates an \gls{event} at time Y.
        \item The \gls{user} stops the recording.
    \end{enumerate}}
    {\begin{itemize}
        \item A recording has been generated (in accordance with \ref{sec:session_recordings}) and stored at the path specified by the configuration
        \item The recording contains both events in accordance with \specref{D300}, \specref{D301} and \specref{D302}. The timestamp of the first event must refer to time X, the timestamp of the second event must refer to time Y.
    \end{itemize}}

    \test{\fmt{FS40}{FS250}{FS54}{FS70}{FS90}{FS51}{FS340}{FS350}}{Event discarding}{The application is running. The configuration file is valid. The configuration specifies to discard events of type "mouse:click".}
    {\begin{enumerate}
        \item The \gls{user} starts a recording.
        \item The \gls{user} creates an \gls{event} of type "mouse:click" by clicking the left mouse button.
        \item The \gls{user} creates an \gls{event} of type "keyboard:keypress" by pressing the 'a' key on his keyboard.
        \item The \gls{user} stops the recording.
    \end{enumerate}}
    {\begin{itemize}
        \item A recording has been generated (in accordance with \ref{sec:session_recordings}) and stored at the path specified by the configuration
        \item The recording contains only the "keyboard:keypress" event in accordance with \specref{D300}, \specref{D301}, \specref{D302} and \specref{D330}.
    \end{itemize}}

    \test{\fmt{FS40}{FS250}{FS54}{FS70}{FS90}{FS51}{FS340}{FS350}{FS411}{FS421}}{Event transforming}{The application is running. The configuration file is valid. The configuration specifies to active a \ref{transforming-module} that transforms \glspl{event} of type "mouse:click" and "keyboard:keypress(ctrl)" into an \glspl{event} of type "ctrl-leftclick"}
    {\begin{enumerate}
        \item The \gls{user} starts a recording.
        \item The \gls{user} creates an \gls{event} of type "keyboard:keypress" by pressing the 'ctrl' key on his keyboard without releasing it.
        \item The \gls{user} creates an \gls{event} of type "mouse:click" by clicking the left mouse button.
        \item The \gls{user} creates an \gls{event} of type "keyboard:keyrelease" by releasing the 'ctrl' key.
        \item The \gls{user} stops the recording.
    \end{enumerate}}
    {\begin{itemize}
        \item A recording has been generated (in accordance with \ref{sec:session_recordings}) and stored at the path specified by the configuration
        \item The recording contains the first three events in accordance with \specref{D300}, \specref{D301},\specref{D302},\specref{D320} and \specref{D330}. It additionally contains a third event of type "ctrl-leftclick" that was created by transforming the first two \glspl{event}.
    \end{itemize}}

    \test{\fmt{FS51}{FS250}{FS54}{FS70}{FS90}{FS340}{FS350}{FS411}{FS421}}{Configuring active modules}{The application is running. The configuration file is valid. The configuration specifies to load the mouse module and to not load the keyboard module}
    {\begin{enumerate}
        \item The \gls{user} starts a recording
        \item The \gls{user} presses the left mouse button which yields an \gls{event} by the mouse module
        \item The \gls{user} presses the 'a' key which would yield an \gls{event} by the keyboard module
        \item The \gls{user} stops the recording
    \end{enumerate}}
    {\begin{itemize}
        \item A recording has been generated (in accordance with \ref{sec:session_recordings}) and stored at the path specified by the configuration
        \item The recording only contains the \gls{event} "mouse:click" event in accordance with \specref{D300}, \specref{D301} and \specref{D302}. It does not contain the \gls{event} that would have been generated by the keyboard module
    \end{itemize}}

    \test{\fmt{FS51}{FS250}{FS54}{FS70}{FS90}{FS340}{FS350}}{Configuring video recording}{The application is running. The configuration file is valid. The configuration specifies to record video with a framerate of 60hz, a bitrate of 4096kbps and a resolution of 1920x1080 pixels.}
    {\begin{enumerate}
        \item The \gls{user} starts a recording.
        \item The \gls{user} stops the recording.
    \end{enumerate}}
    {\begin{itemize}
        \item A recording has been generated (in accordance with \ref{sec:session_recordings}) and stored at the path specified by the configuration
        \item The videostream contained in the recording follows \specref{D40}, where the framerate is 60hz, the bitrate is 4096kpbs (or lower) and the resolution is 1920x1080 pixels.
    \end{itemize}}

    \test{\fmt{FS51}{FS250}{FS54}{FS70}{FS90}{FS340}{FS350}}{Configuring audio recording}{The application is running. The configuration file is valid. The configuration specifies to record video}
    {\begin{enumerate}
        \item The \gls{user} starts a recording.
        \item The \gls{user} stops the recording.
    \end{enumerate}}
    {\begin{itemize}
        \item A recording has been generated (in accordance with \ref{sec:session_recordings}) and stored at the path specified by the configuration.
        \item The videostream contains the optional audiostream.
    \end{itemize}}

    \test{\fmt{FS54}{FS250}{FS70}{FS90}{FS340}{FS350}}{Configuring audio recording}{The application is running. The configuration file is valid. The configuration specifies to store the recording at path "\%userprofile\%\textbackslash documents\textbackslash recordings"}
    {\begin{enumerate}
        \item The \gls{user} starts a recording.
        \item The \gls{user} stops the recording.
    \end{enumerate}}
    {\begin{itemize}
        \item A recording has been generated (in accordance with \ref{sec:session_recordings}) and stored in the "\textbackslash documents\textbackslash recordings" folder inside the user directory of the user currently logged in.
    \end{itemize}}

    \test{\fmt{FS60}{FS310}}{Error detection}{The default-configuration file got invalidated by appending a bracket ' \{ ' to the end of the file.}
    {\begin{enumerate}
        \item The \gls{user} starts the application.
    \end{enumerate}}
    {\begin{itemize}
        \item The application detects the errors in the configuration and displays an error dialogue.
    \end{itemize}}

    \test{\fmt{FS70}{FS80}{FS340}{FS350}}{User controllability (start)}{The application is running. The configuration file is valid.}
    {\begin{enumerate}
        \item The \gls{user} opens the tray menu by clicking on the application icon in the system tray to open the tray menu
        \item The \gls{user} clicks on the "Start Recording" entry
    \end{enumerate}}
    {\begin{itemize}
        \item The application shows an information dialogue
    \end{itemize}}
    
     \test{\fmt{FS70}{FS80}{FS300}}{Information dialogue}{The application currently shows the information dialogue at the start of a recording.}
    {\begin{enumerate}
        \item The user dismisses the information dialogue
    \end{enumerate}}
    {\begin{itemize}
        \item The application starts a recording and shows a recording indicator
    \end{itemize}}
    
\end{tests}

\section{Per-module test cases}

\subsection{System module test cases}

\subsubsection{Window-management module test cases}

\begin{tests}
	\test{\fmt{FS70}{FS54}{FS20}{FS30}{FS250}{FS401}}{Window focus event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user focuses a "Windows Explorer" window.
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains a focus-window event, that contains the title of application A, along with the timestamp at which the user focused the window, the identifier of the window-management module and the "window:focus" type of the event.
	\end{itemize}}
	
	\test{\fmt{FS70}{FS54}{FS20}{FS30}{FS250}{FS402}}{Window move event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user moves a "Windows Explorer" window.
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains a move-window event, that contains the title of application A, old and new location of the window along with the timestamp at which the user moved the window, the identifier of the window-management module and the "window:move" type of the event.
	\end{itemize}}
	
	\test{\fmt{FS70}{FS54}{FS20}{FS30}{FS250}{FS403}}{Window resize event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user resizes a "Windows Explorer" window.
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains a resize-window event, that contains the title of application A, old and new size of the window along with the timestamp at which the user resized the window, the identifier of the window-management module and the "window:resize" type of the event.
	\end{itemize}}
	
	\test{\fmt{FS70}{FS54}{FS20}{FS30}{FS250}{FS404}}{Window maximize/minimize/restore event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user maximizes/minimizes/restores a "Windows Explorer" window.
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains a maximize-window/minimize-window/restore-window event, that contains the title of application A, the new state of the window - "maximized"/"minimized"/"restored" along with the timestamp at which the user maximized/minimized/restored the window, the identifier of the window-management module and the "window:maximize"/"window:minimize"/"window:restore" type of the event.
	\end{itemize}}
\end{tests}

\subsubsection{Mouse module test cases}

\begin{tests}
	\test{\fmt{FS20}{FS30}{FS54}{FS70}{FS250}{FS411}}{Mouse click event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user presses the left/right/middle mouse button in "Windows Explorer".
		\item The user releases the left/right/middle mouse button in "Windows Explorer".
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains a click-mouse event, that contains type of the clicked button - left/right/middle, type of the click - single, HWND associated with "Windows Explorer" window that was clicked, along with the timestamp at which the user clicked the mouse button, the identifier of the mouse-interaction module and the "mouse:left-click"/"mouse:right-click"/"mouse:middle-click" type of the event.
	\end{itemize}}
	
	\test{\fmt{FS20}{FS30}{FS54}{FS70}{FS250}{FS411}}{Mouse double click event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The \gls{user} performs double-clicks the left mouse button.
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains a double-click-mouse event, that contains type of the clicked button - left, type of the click - double, HWND associated with the "Windows Explorer" window that was clicked, along with the timestamp at which the user double clicked the mouse button, the identifier of the mouse-interaction module and the "mouse:left-double-click" type of the event.
	\end{itemize}}
	
	\test{\fmt{FS20}{FS30}{FS54}{FS70}{FS250}{FS412}}{Mouse scroll event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user scrolls the mouse wheel in "Windows Explorer".
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains a scroll-mouse event, that contains scroll amount, HWND associated with the "Windows Explorer" window that was scrolled, along with the timestamp at which the user used the scroll wheel, the identifier of the mouse-interaction module and the "mouse:scroll" type of the event.
	\end{itemize}}
	
	\test{\fmt{FS20}{FS30}{FS54}{FS70}{FS250}{FS413}}{Mouse move event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user moves the mouse.
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains a move-mouse event, that contains movement vector along with the timestamp at which the user moved the mouse, the identifier of the mouse-interaction module and the "mouse:move" type of the event.
	\end{itemize}}
\end{tests}

\subsubsection{Keyboard module test cases}

\begin{tests}
	\test{\fmt{FS20}{FS30}{FS54}{FS70}{FS250}{FS421}}{Keyboard event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user presses a key while a "Windows Explorer" window is focused.
		\item The user releases a key while a "Windows Explorer" window is focused.
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains press-key-keyboard event and release-key-keyboard event. Each event contains name of the pressed/released key, names of all modifier keys that are pressed/released along with the timestamp at which the user pressed/released a key, the identifier of the keyboard-interaction module and the "keyboard:press-key"/"keyboard:release-key" type of the event.
	\end{itemize}}
\end{tests}

\subsection{Clipboard module test cases}

\begin{tests}
	\test{\fmt{FS20}{FS30}{FS54}{FS70}{FS250}{FS340}}{Clipboard event}{The application is running. The configuration file is valid.}
	{\begin{enumerate}
		\item The user starts a new session recording.
		\item The user copies text from a "Microsoft Excel" window.
		\item The user pastes text in the "Mozilla Firefox/Google Chrome" address bar.
		\item The user stops the recording.
	\end{enumerate}}
	{\begin{itemize}
		\item A recording has been created and stored at the path specified by the configuration.
		\item The recording contains copy-clipboard event and paste-clipboard event. Each event contains clipboard text associated with "Microsoft Excel"/"Mozilla Firefox/Google Chrome", type of the clipboard interaction - copy/paste, along with the timestamp at which the user copied/pasted the text, the identifier of the clipboard-interaction module and the "clipboard:copy"/"clipboard:paste" type of the event.
	\end{itemize}}
\end{tests}