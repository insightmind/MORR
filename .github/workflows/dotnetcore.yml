name: Build + Test

on:
  push:
    branches: 
      - master
      - develop
  pull_request:
    branches: 
      - master
      - develop

env:
  APP_SOLUTION_PATH: ${{ 'application/MORR.sln' }}
  BROWSER_EXTENSION_PATH: ${{ 'application/BrowserExtension' }}

jobs:
  dotNET-Core:
    name: Build .NET Core
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v1
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '3.1.100'
    - name: Clean
      run: dotnet clean $APP_SOLUTION_PATH --nologo
    - name: Build
      run: dotnet build $APP_SOLUTION_PATH --configuration Release --nologo
    - name: Run tests
      run: dotnet test $APP_SOLUTION_PATH -t

  TypeScript:
    name: Build Typescript
    runs-on: windows-latest

    steps:
      - uses: actions/checkout@v1
      - name: Install
        run: npm install $BROWSER_EXTENSION_PATH
      - name: Build
        run: npm run build $BROWSER_EXTENSION_PATH
